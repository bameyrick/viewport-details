language: node_js
version: "~> 1.0.0"
node_js:
- 12.18.3
cache: yarn
jobs:
  include:
  - stage: test
    script: yarn lint && yarn test-single && codecov
  - stage: npm-bundle
    script: yarn build && npm version $TRAVIS_BRANCH --allow-same-version --allow-empty
    deploy:
      edge: true
      provider: npm
      email: bameyrick@gmail.com
      api_key:
        secure: BjBo1bsahzedU6dgGIE89eYZ7kTPZVdS7ZKmc98cYuEiYQnt9/kMzADv+dbhANZtlNnnvQ36bQMeHicc5uRVE9aN8Yy6IzEKtIUuNr6Rvt7o/B/qhpfsdxEkb1UACDuFJfQAvo0RHu/OBnQbeshbrJZBLvyqHxFQdP/lJwFThoroEmsJxv6QkOBncicwS+6+jsPzGHEMVQN+ni1xxb8LptVcaQLD/ZHxw6gSnda53K0pYjwv5kuQUZVMQh4MV5CBSv8kzTRsx9LGIbobWLALovMWWrdi3pGG17s9K1AUKnmRNHUNfkCagOeIB8MjFl0ecfqRq7wllJomF6OT9bUWLK3cILY1u5jCp/BXcnBY9Y7jBvM1EEu/XjKEbbyYcovb5+lu+yGKhEYapoyS3bI1f1dh2sREAkf+4eWAekCecybIwCwQtBNKTPNFCia2ks4QMttYppRvBlfbLQAPfHPUnssrl5BedvAdIzGHo5Lbp+0TJPNkopLYoDa13BQh4iAWsQwmKf8BqcVUMjioSPy7qF0Phd6Z+J2eBEFXYe1XEOzYq6fnBxC7jc+MkVONK6jPDnBY/fZiYK3lKPV5gFmNpkCa9t5WK9YUeWzNt6NOFphzhJznH/HaH91Zdf1dTpIYjEWTKMQ9AZ0VT8g+9EyFDMNonc3YhXqxxO8DOReFh/0=
      on:
        tags: true
stages:
- name: test
  if: tag IS NOT present
- name: npm-bundle
  if: tag IS present
