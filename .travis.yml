language: node_js
version: "~> 1.0.0"
node_js:
- 12.18.3
cache: yarn
jobs:
  include:
  - stage: test
    script: yarn lint && yarn test-single && codecov
  - stage: npm-bundle
    script: yarn build && npm version $TRAVIS_BRANCH --allow-same-version --allow-empty
    deploy:
      edge: true
      provider: npm
      email: bameyrick@gmail.com
      api_key:
        secure: zTkbESURCbhU1EICKz2f8Kp4Zrgem0onF6uHDX8FNF1CmCrvT8CIUGNxVZhGroqg1az13HUS13nQLAOYxmevebfKAqv5g5anyrKoLfQ/qwng7ZYl/Szm1oAOFm+ZB1z4hJUMluljSqa742Z2CtAhPfZ/mXaRFa3b/ZD6GYjxGubErT5AaQnPLo1v32CDpgMqKF1Bef1jMr2xIIp7sCP9/z2LRCszndPgu3NM3Ctmrg+NHCX3zNAb1kG4sjuAQPeoBnktWb8tyYIgoA5h/+OF0kcF8cWq6rnMdOCNpR34FLY+I/XOyGA2CkSpcr5jUKbEtITCFayWuJIPWad6RR3A3G3D/vs4H8o2GDP+DpyaF7lUUnKtjBpbztIlDMgs1S7UCkuSJkeczMAPlUcrISzAbOIM3m2UlBWn8+VrNkDt5mJoZMSWrPOh+fYl3tjnJwQvJxfd2wDUcxItEmQv03YNIuug+N9f2su0XaEyTgZ/ouzhVP/hj+ODh1WelMeqbLHkSB85jsIeswRdrqwfQKuJ/+LcbUBRnjw1TwX/qrh21Cp6vUdwXp9AnbV+b2yKN8RWqLxd9XpZ4uPUkRfYBOnsA7R+59Ajj2gmB5KE0iu8gPoDR68C15ZHfTHM0T+VzoN3ZNjpU2nHL4J9W/lW1UQPFLj2XIa/IEnPuzxihsQaJao=
      on:
        tags: true
stages:
- name: test
  if: tag IS NOT present
- name: npm-bundle
  if: tag IS present
